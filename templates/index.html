<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>VMware CIS 检查报告</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 30px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f0f0f0; }
        tr:nth-child(even) { background-color: #fafafa; }
        h2 { margin-top: 40px; }
    </style>
</head>
<body>
    <h1>VMware CIS 检查报告</h1>
    <div id="tables"></div>

    <script>
        // JSON 文件列表
        const jsonFiles = [
    "/log/no_1.2_ntp.json",
    "/log/no_1.4_mem_share_salt.json",
    "/log/no_2.1_tsm_ssh.json",
    "/log/no_2.2_tsm.json",
    "/log/no_2.3_solo_enable_mob.json",
    "/log/no_2.4_snmp_manual.json",
    "/log/no_2.5_dcui_timeout.json",
    "/log/no_2.6_shell_warning_manual.json",
    "/log/no_2.7_password_complexity_manual.json",
    "/log/no_2.8_account_lock_failure.json",
    "/log/no_2.9_account_unlock_time.json",
    "/log/no_2.10_password_history_manual.json",
    "/log/no_2.11_password_max_days_manual.json",
    "/log/no_2.12_session_timeout_api_manual.json",
    "/log/no_2.13_idle_host_client_manual.json",
    "/log/no_2.14_dcui_access.json",
    "/log/no_2.15_exception_users_manual.json",
    "/log/no_2.16_tls_version_manual.json",
    "/log/no_3.1_syslog_persistent.json",
    "/log/no_3.2_syslog_remote_loghost.json",
    "/log/no_3.3_syslog_info_level_manual.json",
    "/log/no_3.4_log_filtering_manual.json",
    "/log/no_3.5_tls_log_verify_manual.json",
    "/log/no_4.1_firewall_services_manual.json",
    "/log/no_4.2_dvfilter_manual.json",
    "/log/no_4.3_bpdu_filter_manual.json",
    "/log/no_4.4_forged_transmits.json",
    "/log/no_4.5_mac_changes.json",
    "/log/no_4.6_vss_promiscuous_mode.json",
    "/log/no_4.7_vss_vlan_restrict.json",
    "/log/no_4.8_vss_vgt_check.json",
    "/log/no_4.9_management_network_manual.json",
    "/log/no_5.1_datastore_unique_names.json"
];


        const tablesDiv = document.getElementById('tables');

        // 遍历每个 JSON 文件
        jsonFiles.forEach(file => {
            fetch(file)
                .then(response => response.json())
                .then(data => {
                    if (!data || data.length === 0) return;

                    // 创建表格标题
                    const h2 = document.createElement('h2');
                    h2.textContent = file;
                    tablesDiv.appendChild(h2);

                    // 创建表格
                    const table = document.createElement('table');
                    const thead = document.createElement('thead');
                    const tbody = document.createElement('tbody');

                    // 表头
                    const headerRow = document.createElement('tr');
                    Object.keys(data[0]).forEach(key => {
                        const th = document.createElement('th');
                        th.textContent = key;
                        headerRow.appendChild(th);
                    });
                    thead.appendChild(headerRow);
                    table.appendChild(thead);

                    // 表体
                    data.forEach(item => {
                        const tr = document.createElement('tr');
                        Object.values(item).forEach(val => {
                            const td = document.createElement('td');
                            if (Array.isArray(val) || typeof val === 'object') {
                                td.textContent = JSON.stringify(val);
                            } else {
                                td.textContent = val !== null ? val : '';
                            }
                            tr.appendChild(td);
                        });
                        tbody.appendChild(tr);
                    });

                    table.appendChild(tbody);
                    tablesDiv.appendChild(table);
                })
                .catch(err => {
                    console.error("加载 JSON 文件失败:", file, err);
                });
        });
    </script>
</body>
</html>
